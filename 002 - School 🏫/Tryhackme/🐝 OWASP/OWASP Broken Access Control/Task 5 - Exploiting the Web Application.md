In the previous task, we learned that the file `functions.php` returns a JSON response upon login. The response contains a **redirect_link** with a parameter that we can test for access control vulnerabilities.

To start testing for this vulnerability, we can intercept the HTTP response and copy the value of the **redirect_link** parameter to our address bar.

![Redirect link in the address bar](https://tryhackme-images.s3.amazonaws.com/user-uploads/645b19f5d5848d004ab9c9e2/room-content/ae62caddd97044d2f502fb843a5792aa.png)  

Since the application redirects the user to dashboard.php while the JSON response can only be seen by intercepting using a proxy tool, we can try changing the parameter’s value from **“false”** to **“true”** or vice versa.

![Modified parameter value in the address bar](https://tryhackme-images.s3.amazonaws.com/user-uploads/645b19f5d5848d004ab9c9e2/room-content/5dd8248de6785f4032080981acd689dc.png)  

Upon changing the value from **false** to **true**, application redirects us to `admin.php`, which is hidden to a normal user by default. Below is the HTTP request that is captured using Burp Suite Proxy.

![Captured HTTP request using Burp Suite Proxy](https://tryhackme-images.s3.amazonaws.com/user-uploads/645b19f5d5848d004ab9c9e2/room-content/ad005cdf8c587872cf3c1ed1fe6b90b3.png)

![Admin Page Preview](https://tryhackme-images.s3.amazonaws.com/user-uploads/645b19f5d5848d004ab9c9e2/room-content/c019a5987cac64d81dc2859b13f56bdc.png)  

Since we have access to admin.php using a low-privilege account, we might as well check for a vertical privilege escalation attack.

Checking the box in the “Admin access” column of the account you registered and clicking the “Save Changes” button will give us admin privileges. Which in return enables us to revoke the access of other admin users.

![Admin Page Preview with modified admin access](https://tryhackme-images.s3.amazonaws.com/user-uploads/5ee9d82ebaa78254d39dc7a7/room-content/b8e6cf35af3196314036bfde4dee77b8.png)

___Answer the questions below___

What kind of privilege escalation happened after accessing admin.php?
	
	Vertical

What parameter allows the attacker to access the admin page?
	
	isadmin

What is the flag in the admin page?
	
	THM{I_C4n_3xpl01t_B4c}


[Task 6 - Mitigation](Task%206%20-%20Mitigation.md)

